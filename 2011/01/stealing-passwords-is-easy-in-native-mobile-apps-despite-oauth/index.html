<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Stealing Passwords is Easy in Native Mobile Apps Despite OAuth &ndash; Adam Wulf</title>
<meta name="robots" content="max-image-preview:large">
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	<link rel="alternate" type="application/rss+xml" title="Adam Wulf &raquo; Feed" href="/feed/">
<link rel="alternate" type="application/rss+xml" title="Adam Wulf &raquo; Comments Feed" href="/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Adam Wulf &raquo; Stealing Passwords is Easy in Native Mobile Apps Despite OAuth Comments Feed" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/feed/">
<link rel="stylesheet" id="wp-block-library-css" href="/wp-includes/css/dist/block-library/style.min.css?ver=6.8.1" type="text/css" media="all">
<style id="classic-theme-styles-inline-css" type="text/css">
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id="global-styles-inline-css" type="text/css">
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel="stylesheet" id="add-anchor-links-style-css" href="/wp-content/plugins/add-anchor-links/assets/css/add-anchor-links.css?ver=1.0.2" type="text/css" media="all">
<link rel="stylesheet" id="slightly-flexboxgrid-css" href="/wp-content/themes/slightly/css/flexboxgrid.min.css?ver=6.8.1" type="text/css" media="all">
<link rel="stylesheet" id="slightly-style-css" href="/wp-content/themes/slightly/style.css?ver=6.8.1" type="text/css" media="all">
<style id="akismet-widget-style-inline-css" type="text/css">

			.a-stats {
				--akismet-color-mid-green: #357b49;
				--akismet-color-white: #fff;
				--akismet-color-light-grey: #f6f7f7;

				max-width: 350px;
				width: auto;
			}

			.a-stats * {
				all: unset;
				box-sizing: border-box;
			}

			.a-stats strong {
				font-weight: 600;
			}

			.a-stats a.a-stats__link,
			.a-stats a.a-stats__link:visited,
			.a-stats a.a-stats__link:active {
				background: var(--akismet-color-mid-green);
				border: none;
				box-shadow: none;
				border-radius: 8px;
				color: var(--akismet-color-white);
				cursor: pointer;
				display: block;
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen-Sans', 'Ubuntu', 'Cantarell', 'Helvetica Neue', sans-serif;
				font-weight: 500;
				padding: 12px;
				text-align: center;
				text-decoration: none;
				transition: all 0.2s ease;
			}

			/* Extra specificity to deal with TwentyTwentyOne focus style */
			.widget .a-stats a.a-stats__link:focus {
				background: var(--akismet-color-mid-green);
				color: var(--akismet-color-white);
				text-decoration: none;
			}

			.a-stats a.a-stats__link:hover {
				filter: brightness(110%);
				box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06), 0 0 2px rgba(0, 0, 0, 0.16);
			}

			.a-stats .count {
				color: var(--akismet-color-white);
				display: block;
				font-size: 1.5em;
				line-height: 1.4;
				padding: 0 13px;
				white-space: nowrap;
			}
		
</style>
<link rel="https://api.w.org/" href="/wp-json/"><link rel="alternate" title="JSON" type="application/json" href="/wp-json/wp/v2/posts/2062"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd">
<meta name="generator" content="WordPress 6.8.1">
<link rel="canonical" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/">
<link rel="shortlink" href="/?p=2062">
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2F2011%2F01%2Fstealing-passwords-is-easy-in-native-mobile-apps-despite-oauth%2F">
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2F%2F2011%2F01%2Fstealing-passwords-is-easy-in-native-mobile-apps-despite-oauth%2F&amp;format=xml">

		<!-- GA Google Analytics @ https://m0n.co/ga -->
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
			ga('create', 'UA-180672-7', 'auto');
			ga('set', 'anonymizeIp', true);
			ga('set', 'forceSSL', true);
			ga('send', 'pageview');
		</script>

	<link rel="pingback" href="/xmlrpc.php">    <style>
        body, button, input, select, textarea, a { 
            color: ;
        }
      
        .menu-toggle {
          color: ;
          background-color: #;
        }
      
        #primary-menu {
          color: ;
          background-color: #;
        }
    </style>

    </head>

<body class="wp-singular post-template-default single single-post postid-2062 single-format-standard wp-theme-slightly">

<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>


	<header id="masthead" class="site-header" role="banner">
  <div class="row">
    <div class="col-xs-12 site-header-col">
		<div class="site-branding">
			                    <p class="site-title"><a href="/" rel="home">Adam Wulf</a></p>
                		</div><!-- .site-branding -->
		<nav id="site-navigation" class="main-navigation" role="navigation">
            <button class="menu-toggle" aria-controls="primary-menu" aria-expanded="false">Menu</button>
			<div class="menu-navigation-container"><ul id="primary-menu" class="menu"><li id="menu-item-5164" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-5164"><a href="/">Home</a></li>
<li id="menu-item-5167" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5167"><a href="/about/">About</a></li>
<li id="menu-item-5166" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5166"><a href="/projects/">Projects</a></li>
<li id="menu-item-5165" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5165"><a href="/open-source/">Open Source</a></li>
</ul></div>		</nav><!-- #site-navigation -->
      </div>
    </div>
	</header><!-- #masthead -->


	<div id="content" class="site-content">

  <div class="row row--index">
    <div class="col-xs-12">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
<article id="post-2062" class="post-2062 post type-post status-publish format-standard hentry category-uncategorized">
    <div class="row no-pad">
      
                    <div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 no-pad">
                <header class="entry-header">
                    <h1 class="entry-title">Stealing Passwords is Easy in Native Mobile Apps Despite OAuth</h1>                    <div class="entry-meta">
                        <span class="posted-on"><time class="entry-date published" datetime="2011-01-12T10:30:19+00:00">January 12, 2011</time><time class="updated" datetime="2020-11-19T03:49:49+00:00">November 19, 2020</time> </span>                    </div><!-- .entry-meta -->
                                    </header><!-- .entry-header -->
                <div class="entry-content">

                    
                    <h3><a href="#preface" aria-hidden="true" class="aal_anchor" id="preface"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Preface</h3>
<p><img decoding="async" class="alignright size-full wp-image-2081" title="oauth broken" src="/files/2011/01/oauth-broken.png" alt="" width="180" height="78" align="right"><a href="http://oauth.net/">OAuth</a> is a fantastic login protocol that allows disparate web applications to all use the same login provider. However, I&rsquo;ve discovered that its use in native mobile applications is borderline dangerous, and in this post I&rsquo;ll describe why.</p>
<p>Last year I released <a href="http://herefilefile.com/">my first (and still only) iPhone application</a>. Even though my app doesn&rsquo;t use OAuth, the then recent <a href="http://arstechnica.com/security/guides/2010/09/twitter-a-case-study-on-how-to-do-oauth-wrong.ars">Twitter/OAuth fiasco</a> stoked my interested in mobile OAuth. I was particularly curious how OAuth providers protected their passwords in their mobile SDKs.</p>
<p>I downloaded the Facebook SDK and poked around in the iPhone simulator, and frankly I didn&rsquo;t like what I saw. In less than an afternoon, I was able to build an app that could steal a user&rsquo;s password as they logged in through Facebook Connect, all 100% transparent to the user, 100% transparent to Facebook, and 100% transparent to Apple. In a word, this is not a good sign for OAuth and native mobile apps. To be clear, <strong>this affects every single OAuth provider and mobile platform, not just Facebook and iOS.</strong></p>
<p>Despite numerous web searches, emails, and even code submission to Facebook, I haven&rsquo;t seen anyone talk about this problem on the web at all. Seeing as how the Facebook Connect SDK is <a href="http://developers.facebook.com/blog/post/213">almost 2 years old</a>, and <a href="http://blog.twitter.com/2010/08/twitter-applications-and-oauth.html">many</a> <a href="http://developer.yahoo.com/oauth/">other</a> <a href="http://wiki.developer.myspace.com/index.php?title=OAuth_Overview">companies</a> <a href="http://about.digg.com/blog/twitter-anywhere-openid-oauth-and-diggs-support-open-standards">are following</a> <a href="http://www.readwriteweb.com/archives/ready_for_gmail_mashups_google_adds_oauth_to_imap.php">suit</a> with OAuth in native mobile SDKs, I think this conversation is long overdue.</p>
<p>In this post, I&rsquo;m going to explain how and why <strong>OAuth in native mobile apps does not secure your password</strong>, and why you should still be wary when logging into Facebook/Twitter/Google/anything through any app except their respective official native mobile apps. I&rsquo;m writing this post to expose the still weak security for single sign on services in native mobile apps. I am not providing any source code, though after reading this post I&rsquo;m sure you&rsquo;ll agree that eavesdropping on an OAuth transaction in a native mobile app is extremely easy even for a novice programmer.</p>
<h3><a href="#the-problem" aria-hidden="true" class="aal_anchor" id="the-problem"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The Problem</h3>
<p>The purpose of Oauth is to let application developers use Twitter/Facebook/anysite&rsquo;s login mechanism, all while keeping the password 100% secret from the application developer. In this world, if the application turns out to be an untrusted malicious application, all the user needs to do is turn off access from that application on Twitter/Facebook/anysite&rsquo;s settings page.</p>
<p>However, <strong>native mobile application developers are still able to access (steal) your password even when using OAuth for login</strong>, all 100% undetected. This means that for native mobile apps, using OAuth is not any more secure than using <a href="http://en.wikipedia.org/wiki/Basic_access_authentication">Basic Auth</a>, and <a href="http://blog.twitter.com/2010/08/twitter-applications-and-oauth.html">Twitter&rsquo;s API change from Basic Auth to OAuth</a> does nothing to protect user&rsquo;s passwords from malicious application developers.</p>
<p>To be clear, this affects every OAuth implementation in native mobile apps, across iOS, Android, and [I believe] Windows 7.</p>
<h3><a href="#when-your-password-is-safe-web-apps" aria-hidden="true" class="aal_anchor" id="when-your-password-is-safe-web-apps"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>When your password <em>is</em> safe: Web Apps</h3>
<p><a href="/files/2011/01/oauth-web-app.png"><img fetchpriority="high" decoding="async" class="alignright size-full wp-image-2082" title="oauth web app" src="/files/2011/01/oauth-web-app.png" alt="" width="400" height="300" align="right" srcset="/wp-content/uploads/2011/01/oauth-web-app.png 400w, /wp-content/uploads/2011/01/oauth-web-app-300x225.png 300w" sizes="(max-width: 400px) 100vw, 400px"></a>As our first example, let&rsquo;s take a look at web apps &ndash; this is true for both mobile web apps and desktop web apps.</p>
<p>OAuth succeeds in protecting the user&rsquo;s login information because the web browser is a 100% trusted agent and ensures that the application code on the web app&rsquo;s domain name cannot access any information on the OAuth providers domain name. This is called <a href="http://en.wikipedia.org/wiki/Same_origin_policy">Same Origin Policy</a>.</p>
<p>For example, when [insert&nbsp;malicious web app here] begins an OAuth login, the browser opens a window/redirects/iframes to the authentication provider (probably Facebook, Twitter, Google, etc). Due to the browser&rsquo;s security, it is impossible for the malicious app to eavesdrop as the user types in their password. After the user enters their username + password into the legitimate login screen, approves (or disapproves) the web app from accessing it&rsquo;s account, and is then redirected back to the potentially malicious web app.</p>
<p>At no point in this transaction does the malicious web app have access to the user&rsquo;s login credentials. Browser security prevents any scripts on the malicious site from interfering/listening to/intercepting the login credentials. It&rsquo;s this trusted and neutral 3rd party browser that makes this negotiation possible. The phone&rsquo;s built in browser acts as the trusted middleman during the OAuth transaction.</p>
<p>Once the user discovers the malicious apps evil plot, all the user needs to do is login to the OAuth provider&rsquo;s trusted site and remove the malicious app from their trusted apps. done.</p>
<p>You&rsquo;re safe, the world is happy, and OAuth saves the day. Not so in native mobile apps, let&rsquo;s take a look:</p>
<h3><a href="#when-your-password-is-not-safe-native-mobile-apps" aria-hidden="true" class="aal_anchor" id="when-your-password-is-not-safe-native-mobile-apps"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>When your password <em>is not</em> safe: Native Mobile Apps</h3>
<p><a href="/files/2011/01/oauth-native-mobile.png"><img decoding="async" class="alignright size-full wp-image-2083" title="oauth native mobile" src="/files/2011/01/oauth-native-mobile.png" alt="" width="400" height="300" align="right" srcset="/wp-content/uploads/2011/01/oauth-native-mobile.png 400w, /wp-content/uploads/2011/01/oauth-native-mobile-300x225.png 300w" sizes="(max-width: 400px) 100vw, 400px"></a>In native mobile apps, the mobile application itself takes the place of the browser, so there is no longer a trusted neutral 3rd party browser to act as the trusted middle man in OAuth transactions &ndash; the mobile app itself acts as both the OAuth client and the OAuth middle man!</p>
<p>So what does this mean? It means any native mobile app implementing OAuth can steal your login credentials, completely transparent to you the user, the OAuth provider, and even the phone manufacturer/carrier.</p>
<p>Since the mobile app hosts a tiny instance of the web browser inside of itself, that app can see/do/act on anything inside the web content it shows &ndash; no exceptions. This means the Same Origin Policy we discussed above is now out the window. Even though the native app uses WebKit to do the rendering/browsing, that native app can also do absolutely anything to any webpage loaded inside of it, including stealing passwords, without the loaded website even knowing.</p>
<p>I&rsquo;m not going to show any code, but I&rsquo;ve verified in code that this is in fact possible. I&rsquo;ve effectively stolen my own Facebook password using <a href="https://github.com/facebook/facebook-ios-sdk">Facebook&rsquo;s provided iOS OAuth library</a>. It only took minor modifications using entirely publicly available APIs in iOS. The exact same attack could be used in any app that logins with Twitter, and is not specific to iOS &ndash; this affects Android (and presumably Windows 7 though I haven&rsquo;t looked at their API).</p>
<p><strong>How the attack works:</strong></p>
<ol>
<li>Malicious attacker builds native mobile app and&nbsp;uses any publicly available OAuth SDK from Facebook/Twitter/anyone</li>
<li>The attacker loads the legitimate OAuth login screen using a web view available from the phone&rsquo;s public SDK</li>
<li>The attacker runs JavaScript on that webview object, attaching JavaScript event handlers to any &lt;input&gt; element on the page</li>
<li>When the value of an &lt;input&gt; changes, the injected JavaScript notifies the wrapping native application about the change</li>
<li>User authenticates, and OAuth transaction is completed as normal &ndash; except the malicious app has been listening to every keystroke! Password: compromised!</li>
<li><a href="http://macapper.com/2010/08/01/android-hack-clarification-and-update/">Malicious app uploads credentials to anonymous server in China</a></li>
</ol>
<p>Since the attacker is (a) using publicly available APIs to (b) inject JavaScript on the authentication page (even if the page is over SSL), the malicious app developer is able to listen as the user types in their credentials. The OAuth provider has zero visibility that this attack is going on; there is no way to mitigate it from the provider side. Even a walled garden app store wouldn&rsquo;t be able to weed out malicious apps based on (a) static analysis of code or (b) watching for malicious network traffic.</p>
<p><strong>This is all because the embedded browser in native applications cannot be the trusted middleman in the OAuth handshake.</strong></p>
<h3><a href="#mobile-web-1-mobile-native-0" aria-hidden="true" class="aal_anchor" id="mobile-web-1-mobile-native-0"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mobile Web: 1, Mobile Native: 0</h3>
<p>Currently, the only secure way for OAuth to exist in mobile is for mobile <em>web</em> applications. These applications still run in a trusted 3rd party browser that prevents cross domain script execution. Since mobile native apps fill the role of OAuth client <em>and</em> trusted browser, the user&rsquo;s login credentials are not secure.</p>
<p>It should be noted that <a href="http://www.oauth.net/">OAuth&rsquo;s website</a> makes no mention of using OAuth for native mobile apps, but clearly mobile app developers are still using it to solve the elusive secure authentication problem.</p>
<p><strong>Again, this affects 100% of OAuth implementations in native mobile applications, regardless of OAuth provider or mobile platform.</strong></p>
<h3><a href="#solutions" aria-hidden="true" class="aal_anchor" id="solutions"><svg aria-hidden="true" class="aal_svg" height="16" version="1.1" viewbox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Solutions?</h3>
<p>For a long time, Twitter provided only basic auth for it&rsquo;s API, but its more recent OAuth API isn&rsquo;t actually any more secure. I believe that the only way to allow secure OAuth within native mobile apps is to have a more strict web browser API for native app developers, and to properly notify OAuth providers when their service is being accessed from an insecure mobile browser. Unfortunately the safest solution right now: don&rsquo;t use OAuth.</p>
<p>I&rsquo;m not sure what the correct long term solution is for login in native mobile apps, but OAuth currently falls very short. Mobile still has a long way to go to keep users passwords <a href="https://www.zdnet.com/article/spyphone-app-harvests-personal-data-from-stock-iphones/">and data</a> safe.</p>
                </div><!-- .entry-content -->
                <footer class="entry-footer">
                                    </footer><!-- .entry-footer -->
            </div>
                
        
    </div><!-- end .row-->
</article><!-- #post-## -->
<div class="row no-pad"><div class="col-xs-12 col-md-10 col-md-offset-1 no-pad"><div class="read-next"><span>Read this next</span><h2><a href="/2010/12/adventures-in-exotic-domain-buying/" title="Adventures in Exotic Domain Buying">Adventures in Exotic Domain Buying</a></h2></div></div></div><div class="col-xs-12 col-sm-10 col-sm-offset-1 col-md-8 col-md-offset-2 no-pad">
<div id="comments" class="comments-area">

			<h2 class="comments-title">
			17 thoughts on &ldquo;<span>Stealing Passwords is Easy in Native Mobile Apps Despite OAuth</span>&rdquo;		</h2><!-- .comments-title -->

		
		<ol class="comment-list">
					<li id="comment-18150" class="pingback even thread-even depth-1">
			<div class="comment-body">
				Pingback: <a href="http://topsy.com/adamwulf.me/2011/01/12/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?utm_source=pingback&amp;utm_campaign=L2" class="url" rel="ugc external nofollow">Tweets that mention Stealing Passwords is Easy in Native Mobile Apps Despite OAuth | Wulf -- Topsy.com</a> 			</div>
		</li><!-- #comment-## -->
		<li id="comment-18153" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-18153" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/179287ac969356470a3ba4d1b51c9c1ee2a5533382e74d89d37a66f02410d800?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/179287ac969356470a3ba4d1b51c9c1ee2a5533382e74d89d37a66f02410d800?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">Tim</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-18153"><time datetime="2011-01-12T12:59:05+00:00">January 12, 2011 at 12:59 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Umm, so, to summarize, don&rsquo;t type your password into an untrusted application.  Thanks for that brilliant piece of advice.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=18153#respond" data-commentid="18153" data-postid="2062" data-belowelement="div-comment-18153" data-respondelement="respond" data-replyto="Reply to Tim" aria-label="Reply to Tim">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-18155" class="comment even thread-even depth-1">
			<article id="div-comment-18155" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/04a88f7c4062107689ff6e909be01c48348827b815fa22267573170c789c1737?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04a88f7c4062107689ff6e909be01c48348827b815fa22267573170c789c1737?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn"><a href="http://keturn.net/" class="url" rel="ugc external nofollow">Kevin Turner</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-18155"><time datetime="2011-01-12T13:25:10+00:00">January 12, 2011 at 1:25 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>Right, you can&rsquo;t say &ldquo;this application is untrusted&rdquo; and then embed a browser into it and pretend you can trust the browser while not trusting the application.</p>
<p>So what you&rsquo;d want to do is use another flow where the app says &ldquo;hey, go to this URL in your trusted browser&rdquo;, and the provider shows a short, temporary request token to a callback URL, or, if necessary, that the user types in.</p>
<p>But there&rsquo;s no incentive for an app developer to do it that way, and lots of disincentive.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=18155#respond" data-commentid="18155" data-postid="2062" data-belowelement="div-comment-18155" data-respondelement="respond" data-replyto="Reply to Kevin Turner" aria-label="Reply to Kevin Turner">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-18157" class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-18157" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/24f16ea46f4db8d9b8c6e0c6be5493a2d49242253b1847bbbe55beccecc7c001?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/24f16ea46f4db8d9b8c6e0c6be5493a2d49242253b1847bbbe55beccecc7c001?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">Adam Wulf</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-18157"><time datetime="2011-01-12T13:54:48+00:00">January 12, 2011 at 1:54 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>@Tim, the promise of OAuth is that you can login to any application, trusted or not, and still be safe. That&rsquo;s the expectation of users/devs/providers and it&rsquo;s simply not true.</p>
<p>@Kevin, exactly right. and it&rsquo;s a terrible user experience to kick the user from the mobile app to the mobile browser and back again.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=18157#respond" data-commentid="18157" data-postid="2062" data-belowelement="div-comment-18157" data-respondelement="respond" data-replyto="Reply to Adam Wulf" aria-label="Reply to Adam Wulf">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-18182" class="comment even thread-even depth-1">
			<article id="div-comment-18182" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/bd5fc54582b861cba4156deb197ac4ed0fc2ffc3f51fe3fd0b5ecbbf3a6678a0?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/bd5fc54582b861cba4156deb197ac4ed0fc2ffc3f51fe3fd0b5ecbbf3a6678a0?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn"><a href="http://workingsoftware.com.au/page/CERES_looking_for_volunteers" class="url" rel="ugc external nofollow">Iain Dooley</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-18182"><time datetime="2011-01-12T18:24:40+00:00">January 12, 2011 at 6:24 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>The same is true of any native app. If I download an application and install it on my PC and it pretends to use OAuth then of course it can get my password.</p>
<p>If someone created a web browser called SpyHackBrowser and I installed it then that web browser could just as easily intercept every single key stroke I ever make and take all my passwords to everything.</p>
<p>&ldquo;@Tim, the promise of OAuth is that you can login to any application, trusted or not, and still be safe. That&rsquo;s the expectation of users/devs/providers and it&rsquo;s simply not true.&rdquo;</p>
<p>Correction: the promise of OAuth is that you can login to any *website*, trusted or not, and still be safe. Native applications on any platform are fundamentally different from web applications.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=18182#respond" data-commentid="18182" data-postid="2062" data-belowelement="div-comment-18182" data-respondelement="respond" data-replyto="Reply to Iain Dooley" aria-label="Reply to Iain Dooley">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-18254" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-18254" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/04a88f7c4062107689ff6e909be01c48348827b815fa22267573170c789c1737?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/04a88f7c4062107689ff6e909be01c48348827b815fa22267573170c789c1737?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn"><a href="http://keturn.net/" class="url" rel="ugc external nofollow">Kevin Turner</a></b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-18254"><time datetime="2011-01-13T09:41:15+00:00">January 13, 2011 at 9:41 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>@Iain: I haven&rsquo;t been following OAuth&rsquo;s more recent developments, but IIRC, this certainly was one of the use cases on the table in the initial phases of the specification.</p>
<p>And here you&rsquo;re *still* accessing a website, but it&rsquo;s the native app doing it on your behalf, rather than a webapp or the browser acting as a user-agent.</p>
<p>So, like OpenID, here you have a wire protocol that&rsquo;s basically sound, but really needs tighter integration between the infrastructure on the client side and the provider to get a good user experience.  And, like OpenID, OAuth providers have the *option* of authenticating you with something you can&rsquo;t sniff and replay (Phone Factor seems like an especially good method for apps on phone platforms), but they don&rsquo;t, because even after things like the Gawker leak, you basically don&rsquo;t care if anyone steals your password.</p>
<p>(Not that I&rsquo;m bitter or anything.)</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=18254#respond" data-commentid="18254" data-postid="2062" data-belowelement="div-comment-18254" data-respondelement="respond" data-replyto="Reply to Kevin Turner" aria-label="Reply to Kevin Turner">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-18303" class="pingback even thread-even depth-1">
			<div class="comment-body">
				Pingback: <a href="http://uniquecomuniqua.wordpress.com/2011/01/14/warning-stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth-12jan11/" class="url" rel="ugc external nofollow">Warning &ndash; Stealing Passwords is Easy in Native Mobile Apps Despite OAuth [12Jan11] &laquo; Uniquecomuniqua's Blog</a> 			</div>
		</li><!-- #comment-## -->
		<li id="comment-21290" class="pingback odd alt thread-odd thread-alt depth-1">
			<div class="comment-body">
				Pingback: <a href="http://www.open-intelligence.co.uk/tbook/?p=4937" class="url" rel="ugc external nofollow">Warning &ndash; Stealing Passwords is Easy in Native Mobile Apps Despite OAuth [12Jan11] | The Book</a> 			</div>
		</li><!-- #comment-## -->
		<li id="comment-42746" class="comment even thread-even depth-1">
			<article id="div-comment-42746" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/e5e59036936921987bf63511c62e69e6b85b9b1d50ed216b687f41115fa5f8be?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/e5e59036936921987bf63511c62e69e6b85b9b1d50ed216b687f41115fa5f8be?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">joe Alex</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-42746"><time datetime="2011-07-06T14:39:48+00:00">July 6, 2011 at 2:39 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>with iOS SDK, UIWebView acts just like a browser, so it does have the same origin policy.  Can you please share code to proof your concept?</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=42746#respond" data-commentid="42746" data-postid="2062" data-belowelement="div-comment-42746" data-respondelement="respond" data-replyto="Reply to joe Alex" aria-label="Reply to joe Alex">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-43037" class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-43037" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/24f16ea46f4db8d9b8c6e0c6be5493a2d49242253b1847bbbe55beccecc7c001?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/24f16ea46f4db8d9b8c6e0c6be5493a2d49242253b1847bbbe55beccecc7c001?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">Adam Wulf</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-43037"><time datetime="2011-07-07T23:18:05+00:00">July 7, 2011 at 11:18 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>@joe,</p>
<p>In the above steps:<br>
#3 happens in [UIWebView stringByEvaluatingJavaScriptFromString:] to attach event handlers and<br>
#4 is when the webview&rsquo;s delegate method [webView:shouldStartLoadWithRequest:navigationType:] is called by the javascript from #3 using window.open()</p>
<p>same origin doesn&rsquo;t apply since the javascript isn&rsquo;t using an XMLHttpRequest</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=43037#respond" data-commentid="43037" data-postid="2062" data-belowelement="div-comment-43037" data-respondelement="respond" data-replyto="Reply to Adam Wulf" aria-label="Reply to Adam Wulf">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-44018" class="comment even thread-even depth-1">
			<article id="div-comment-44018" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/4f1def51892e9758174e8cb005528fcdf9706c32bd2eaf55ff5a28c4a0881e4b?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4f1def51892e9758174e8cb005528fcdf9706c32bd2eaf55ff5a28c4a0881e4b?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">mistaguy</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-44018"><time datetime="2011-07-13T15:12:02+00:00">July 13, 2011 at 3:12 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>So what you are saying is that if this is possible, then any native app irrespective of whether u use oauth or not, passwords can be stolen using the webview. I will confirm this soon on android. Hence Manufacturers of Phones should provide a protection scheme for password/input fields on webviews!eg Listeners/events should be well defined for this field, if not avoided.It also cautions Androids Openness to webview.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=44018#respond" data-commentid="44018" data-postid="2062" data-belowelement="div-comment-44018" data-respondelement="respond" data-replyto="Reply to mistaguy" aria-label="Reply to mistaguy">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-44036" class="comment byuser comment-author-admin bypostauthor odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-44036" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/24f16ea46f4db8d9b8c6e0c6be5493a2d49242253b1847bbbe55beccecc7c001?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/24f16ea46f4db8d9b8c6e0c6be5493a2d49242253b1847bbbe55beccecc7c001?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">Adam Wulf</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-44036"><time datetime="2011-07-13T18:13:05+00:00">July 13, 2011 at 6:13 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>@mistaguy, that&rsquo;s exactly right. a native application can steal absolutely any data out of a UIWebView including passwords.</p>
<p>I think this is an especially bad thing for OAuth, since users will assume that OAuth logins are especially secure since they are so official looking &ndash; loading the host website and all</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=44036#respond" data-commentid="44036" data-postid="2062" data-belowelement="div-comment-44036" data-respondelement="respond" data-replyto="Reply to Adam Wulf" aria-label="Reply to Adam Wulf">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-44102" class="comment even thread-even depth-1">
			<article id="div-comment-44102" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/4f1def51892e9758174e8cb005528fcdf9706c32bd2eaf55ff5a28c4a0881e4b?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/4f1def51892e9758174e8cb005528fcdf9706c32bd2eaf55ff5a28c4a0881e4b?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">mistaguy</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-44102"><time datetime="2011-07-14T03:38:32+00:00">July 14, 2011 at 3:38 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>@Adam Wulf good then.Since there is no solution as of now, i have kind of thought of widget based option for other Developers for an API platform .the way this operates is that Developers are provided with a library that they use for creating apps that are install able to the Parent Native Mobile App.just like snaptu.such that all Oauth Password Stuff is handled securely and solely by the Parent app hence. Developers then just use interfaces in a library to create their widget based app to be installed on the Native Parent App. Hence a serious Warning must be availed on the website,etc for the users who sign up and especially those who root their android phones. If this widget based option security is handled well with proper cryptography<br>
, then even a rooted use is still save. I will see how this works and if successful, i will github and blog. Otherwise thanks for the Post, i read it at the time when am creating an API</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=44102#respond" data-commentid="44102" data-postid="2062" data-belowelement="div-comment-44102" data-respondelement="respond" data-replyto="Reply to mistaguy" aria-label="Reply to mistaguy">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-201770" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-201770" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/f918acf49f50a29fc3b2ec408fc5d7d90e91dc6eef10172c09e03e24f0b7157e?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/f918acf49f50a29fc3b2ec408fc5d7d90e91dc6eef10172c09e03e24f0b7157e?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">Steve</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-201770"><time datetime="2013-02-04T09:22:30+00:00">February 4, 2013 at 9:22 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>As a consumer this implies there is a risk of using oAuth if the application is from an un moderated app store. Did you ever try to submit your app to iTunes? I would expect / hope that they would run code scanning to detect these kind of security issues &ndash; but maybe I am being too hopeful.</p>
<p>Of course there is still a risk that moderation fails to spot these apps, but it is a small point of mitigation.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=201770#respond" data-commentid="201770" data-postid="2062" data-belowelement="div-comment-201770" data-respondelement="respond" data-replyto="Reply to Steve" aria-label="Reply to Steve">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-202852" class="comment byuser comment-author-admin bypostauthor even thread-even depth-1">
			<article id="div-comment-202852" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/24f16ea46f4db8d9b8c6e0c6be5493a2d49242253b1847bbbe55beccecc7c001?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/24f16ea46f4db8d9b8c6e0c6be5493a2d49242253b1847bbbe55beccecc7c001?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">Adam Wulf</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-202852"><time datetime="2013-02-08T15:18:49+00:00">February 8, 2013 at 3:18 pm</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>@Steve, that&rsquo;s just the thing about this attack. Even with Apple&rsquo;s moderated approval process, a static code analyzer won&rsquo;t be able to detect this attack (especially b/c the attack uses 100% public APIs). Since the OAuth handshake completes normally, this attack would be completely invisible to the human reviewer as well, even if they were actively looking for it.</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=202852#respond" data-commentid="202852" data-postid="2062" data-belowelement="div-comment-202852" data-respondelement="respond" data-replyto="Reply to Adam Wulf" aria-label="Reply to Adam Wulf">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-298192" class="comment odd alt thread-odd thread-alt depth-1">
			<article id="div-comment-298192" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/a1e31e5d9bba879a9e6f4d88c46113d94639160bc5e61ce877ca7fceb3fc8b21?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a1e31e5d9bba879a9e6f4d88c46113d94639160bc5e61ce877ca7fceb3fc8b21?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">Alain</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-298192"><time datetime="2014-02-10T03:44:43+00:00">February 10, 2014 at 3:44 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p>From the oauth rfc:<br>
Standards Track (Page 52)</p>
<p> An embedded user-agent poses a security challenge because resource<br>
      owners are authenticating in an unidentified window without access<br>
      to the visual protections found in most external user-agents.  An<br>
      embedded user-agent educates end-users to trust unidentified<br>
      requests for authentication (making phishing attacks easier to<br>
      execute).</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=298192#respond" data-commentid="298192" data-postid="2062" data-belowelement="div-comment-298192" data-respondelement="respond" data-replyto="Reply to Alain" aria-label="Reply to Alain">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		<li id="comment-510723" class="comment even thread-even depth-1">
			<article id="div-comment-510723" class="comment-body">
				<footer class="comment-meta">
					<div class="comment-author vcard">
						<img alt="" src="https://secure.gravatar.com/avatar/a498824b8538f6d00227a52d4de2ace02ea16d24062177924234d8d7f0a4d47d?s=32&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/a498824b8538f6d00227a52d4de2ace02ea16d24062177924234d8d7f0a4d47d?s=64&amp;d=mm&amp;r=g 2x" class="avatar avatar-32 photo" height="32" width="32" loading="lazy" decoding="async">						<b class="fn">Matt C</b> <span class="says">says:</span>					</div><!-- .comment-author -->

					<div class="comment-metadata">
						<a href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#comment-510723"><time datetime="2016-07-24T03:19:39+00:00">July 24, 2016 at 3:19 am</time></a>					</div><!-- .comment-metadata -->

									</footer><!-- .comment-meta -->

				<div class="comment-content">
					<p><a href="https://tools.ietf.org/html/draft-wdenniss-oauth-native-apps-02" rel="nofollow ugc">https://tools.ietf.org/html/draft-wdenniss-oauth-native-apps-02</a></p>
<p>Excerpt from this link&hellip;<br>
OAuth 2.0 authorization requests from native apps should only be made<br>
   through external user-agents such as the system browser (including<br>
   via an in-app browser tab).  This specification details the security<br>
   and usability reasons why this is the case, and how native apps and<br>
   authorization servers can implement this best practice.</p>
<p>    The OAuth 2.0 [RFC6749] authorization framework, documents two<br>
   approaches in Section 9 for native apps to interact with the<br>
   authorization endpoint: via an embedded user-agent, or an external<br>
   user-agent.</p>
<p>   This document recommends external user-agents like in-app browser<br>
   tabs as the only secure and usable choice for OAuth.  It documents<br>
   how native apps can implement authorization flows with such agents,<br>
   and the additional requirements of authorization servers needed to<br>
   support such usage</p>
				</div><!-- .comment-content -->

				<div class="reply"><a rel="nofollow" class="comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/?replytocom=510723#respond" data-commentid="510723" data-postid="2062" data-belowelement="div-comment-510723" data-respondelement="respond" data-replyto="Reply to Matt C" aria-label="Reply to Matt C">Reply</a></div>			</article><!-- .comment-body -->
		</li><!-- #comment-## -->
		</ol><!-- .comment-list -->

			<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2011/01/stealing-passwords-is-easy-in-native-mobile-apps-despite-oauth/#respond" style="display:none;">Cancel reply</a></small></h3><form action="/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> <span class="required-field-message">Required fields are marked <span class="required">*</span></span></p><p class="comment-form-comment"><label for="comment">Comment <span class="required">*</span></label> <textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required></textarea></p><p style="clear: both;" class="subscribe-to-comments">
			<input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;">
			<label for="subscribe">Notify me of followup comments via e-mail</label>
			</p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" autocomplete="name" required></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" value="" size="30" maxlength="100" aria-describedby="email-notes" autocomplete="email" required></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" value="" size="30" maxlength="200" autocomplete="url"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="2062" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="f9e4b5a484"></p><p style="display: none !important;" class="akismet-fields-container" data-prefix="ak_"><label>&Delta;<textarea name="ak_hp_textarea" cols="45" rows="8" maxlength="100"></textarea></label><input type="hidden" id="ak_js_1" name="ak_js" value="152"><script>document.getElementById( "ak_js_1" ).setAttribute( "value", ( new Date() ).getTime() );</script></p></form>	</div><!-- #respond -->
	
</div><!-- #comments --></div>
		</main><!-- #main -->
	</div><!-- #primary -->
    </div>

    </div>


	</div><!-- #content -->

	<footer id="colophon" class="site-footer" role="contentinfo">

  <div class="row">
    <div class="col-xs-12">
        
		<div class="site-info">
            &copy; 2025 <a href="/" rel="home">Adam Wulf</a> &bull; <a href="https://slightlytheme.com/?ref=footer">Slightly Theme</a>		</div><!-- .site-info -->

    </div>
    </div>
        
	</footer><!-- #colophon -->
</div><!-- #page -->

<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/slightly\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="text/javascript">/* <![CDATA[ */!function(e,n){var r={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":false,"rawcodeDbclick":false,"textOverflow":"break","linenumbers":true,"theme":"wpcustom","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""},"resources":["\/wp-content\/plugins\/enlighter\/cache\/enlighterjs.min.css?TMA22bS9bPYA1tn","\/wp-content\/plugins\/enlighter\/resources\/enlighterjs\/enlighterjs.min.js"]},o=document.getElementsByTagName("head")[0],t=n&&(n.error||n.log)||function(){};e.EnlighterJSINIT=function(){!function(e,n){var r=0,l=null;function c(o){l=o,++r==e.length&&(!0,n(l))}e.forEach(function(e){switch(e.match(/\.([a-z]+)(?:[#?].*)?$/)[1]){case"js":var n=document.createElement("script");n.onload=function(){c(null)},n.onerror=c,n.src=e,n.async=!0,o.appendChild(n);break;case"css":var r=document.createElement("link");r.onload=function(){c(null)},r.onerror=c,r.rel="stylesheet",r.type="text/css",r.href=e,r.media="all",o.appendChild(r);break;default:t("Error: invalid file extension",e)}})}(r.resources,function(e){e?t("Error: failed to dynamically load EnlighterJS resources!",e):"undefined"!=typeof EnlighterJS?EnlighterJS.init(r.selectors.block,r.selectors.inline,r.options):t("Error: EnlighterJS resources not loaded yet!")})},(document.querySelector(r.selectors.block)||document.querySelector(r.selectors.inline))&&e.EnlighterJSINIT()}(window,console); /* ]]> */</script><script type="text/javascript" src="/wp-content/themes/slightly/js/navigation.js?ver=20151215" id="slightly-navigation-js"></script>
<script type="text/javascript" src="/wp-content/themes/slightly/js/skip-link-focus-fix.js?ver=20151215" id="slightly-skip-link-focus-fix-js"></script>
<script type="text/javascript" src="/wp-includes/js/comment-reply.min.js?ver=6.8.1" id="comment-reply-js" async="async" data-wp-strategy="async"></script>
<script defer type="text/javascript" src="/wp-content/plugins/akismet/_inc/akismet-frontend.js?ver=1749187471" id="akismet-frontend-js"></script>

</body>
</html>
