+++
title = "Links with borders in TinyMCE"
date = "2009-02-17T19:18:31+0000"
slug = "links-with-borders-in-tinymce"
type = "post"
+++

<p>One of my primary projects that I work on at Jive is the rich text editor for Clearspace. I first joined Jive last April and began work completely revamping the RTE for <a href="/2008/08/28/clearspace-25-announced/">the 2.5 release</a>. Over the course of development and during bug squashing since then, I’ve seen some crazy bugs in various browsers, but I wanted to highlight one I just spent the better part of the day debugging.</p>
<p>Our RTE is a heavily modified TinyMCE editor with <em>lots</em> of custom Jive plugins. Most of the custom work we’ve done fixes small bugs and inconsistencies of TinyMCE across Safari, Firefox, and IE 6 &amp; 7, but some of our customizations are just nice UI touches to make the experience just a little bit easier.</p>
<p>One such feature is the blue border around link text when the cursor is “inside” the anchor tag. Here is a quick video showing link borders working correctly in Firefox:</p>
<p><object data="http://content.screencast.com/users/adamwulf/folders/Jing/media/e0d6e737-b197-4eb9-b824-c12e20b037ce/jingswfplayer.swf" height="261" type="application/x-shockwave-flash" width="388"><param name="quality" value="high"/><param name="bgcolor" value="#FFFFFF"/><param name="flashVars" value="thumb=http://content.screencast.com/users/adamwulf/folders/Jing/media/e0d6e737-b197-4eb9-b824-c12e20b037ce/FirstFrame.jpg&amp;width=388&amp;height=261&amp;content=http://content.screencast.com/users/adamwulf/folders/Jing/media/e0d6e737-b197-4eb9-b824-c12e20b037ce/00000027.swf"/><param name="allowFullScreen" value="true"/><param name="scale" value="showall"/><param name="allowScriptAccess" value="always"/><param name="base" value="http://content.screencast.com/users/adamwulf/folders/Jing/media/e0d6e737-b197-4eb9-b824-c12e20b037ce/"/><param name="src" value="http://content.screencast.com/users/adamwulf/folders/Jing/media/e0d6e737-b197-4eb9-b824-c12e20b037ce/jingswfplayer.swf"/><param name="flashvars" value="thumb=http://content.screencast.com/users/adamwulf/folders/Jing/media/e0d6e737-b197-4eb9-b824-c12e20b037ce/FirstFrame.jpg&amp;width=388&amp;height=261&amp;content=http://content.screencast.com/users/adamwulf/folders/Jing/media/e0d6e737-b197-4eb9-b824-c12e20b037ce/00000027.swf"/><param name="allowfullscreen" value="true"/></object></p>
<p>Oddly enough, there was a bug in Safari that didn’t let the cursor escape that link tag when pressing the down arrow key. In fact, the blue border downright trapped the cursor, even when it was nowhere near the anchor tag. Check out the video below showing the error in Safari when using arrow keys to navigate the document:</p>
<p><object data="http://content.screencast.com/users/adamwulf/folders/Jing/media/c5d42a09-1c39-4962-8417-15b0ea374305/jingswfplayer.swf" height="252" type="application/x-shockwave-flash" width="388"><param name="quality" value="high"/><param name="bgcolor" value="#FFFFFF"/><param name="flashVars" value="thumb=http://content.screencast.com/users/adamwulf/folders/Jing/media/c5d42a09-1c39-4962-8417-15b0ea374305/FirstFrame.jpg&amp;width=388&amp;height=252&amp;content=http://content.screencast.com/users/adamwulf/folders/Jing/media/c5d42a09-1c39-4962-8417-15b0ea374305/00000026.swf"/><param name="allowFullScreen" value="true"/><param name="scale" value="showall"/><param name="allowScriptAccess" value="always"/><param name="base" value="http://content.screencast.com/users/adamwulf/folders/Jing/media/c5d42a09-1c39-4962-8417-15b0ea374305/"/><param name="src" value="http://content.screencast.com/users/adamwulf/folders/Jing/media/c5d42a09-1c39-4962-8417-15b0ea374305/jingswfplayer.swf"/><param name="flashvars" value="thumb=http://content.screencast.com/users/adamwulf/folders/Jing/media/c5d42a09-1c39-4962-8417-15b0ea374305/FirstFrame.jpg&amp;width=388&amp;height=252&amp;content=http://content.screencast.com/users/adamwulf/folders/Jing/media/c5d42a09-1c39-4962-8417-15b0ea374305/00000026.swf"/><param name="allowfullscreen" value="true"/></object></p>
<p>Since this wasn’t happening in a default install of TinyMCE, I assumed that somewhere our custom javascript was screwing things up in Safari – but after reverting all of our changes back to the default TinyMCE source files with zero plugins, I could <em>still</em> reproduce the error!</p>
<p>Of all things, it turned out to be a problem with how Safari handles the CSS for the anchor tag. Leaving either or both of these rules causes the funky cursor behavior in Safari. Removing both of the rules below solved the problem:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="css">a{
    border: 1px solid transparent;
}
a.active_link{
    border: 1px solid blue;
}</pre>
<p>So if you’re ever trying to add borders around links in TinyMCE in Safari, you can now rest assured that you can’t without adding some really wonky cursor problems. 🙂</p>
<p>Of course, removing these CSS rules would mean that not only Safari wouldn’t see borders, but Firefox and IE would also be borderless. 🙁 Not wanting to sacrifice usability, I wanted to find a way to turn this off only for Safari, but leave it enabled for the other browsers.</p>
<p>My constraints: don’t serve different CSS files to different browsers (hell to maintain), and don’t serve an additional CSS file to non-Safari browsers (don’t want more http requests).</p>
<p>The fix was to pull those 2 CSS rules out of our custom content.css file, and use a TinyMCE plugin to insert them dynamically when the editor initializes. If TinyMCE finds that it’s running in Safari, nothing happens and that CSS isn’t run, but if it’s <em>not</em> Safari, then dynamically create a &lt;style&gt; tag with those 2 CSS rules and add it to the &lt;head&gt; of the editor’s iframe.</p>
<p>I’m sure I’m hitting a broad audience when I say: Hopefully as you develop your own highly customized RTE based on TinyMCE for your company, and find funny cursor problems in Safari when adding borders to your links, you won’t spend as much time as I have and will know just what to do! 😉</p>